[POST] booking/hotel
=======
#Оглавление

тут список
#Кратко

#Примечание

Черновое описание

##Параметры запроса
###Специальные обозначения и условия
 **opt** - (optional condition) опциональное условие бронирования. Помечаются условия бронирования и другие параметры, которые могут быть проигнорированы в запросе если клиенту этот параметр не важен. Если параметр прeдоставлен в запросе, но он не совпадает с фактическим параметром в базе - запрос будет возвращен обратно с указаниями на несовпадения, стадией, на которой был остановлен процесс. Этот функционал существует для того, чтобы клиентская сторона могла подтвердить изменения в условиях или произвести другие действия по корректировке запроса. Если же таковые параметры упущены система произведет автоматическое принятие параметров на основе существующих в базе.
Важно:  если клиентская сторона хочет предварительно "проверить" сложившиеся параметры по бронированию необходимо передать в запросе параметр nextState с кодом стадии бронирования (см. "Стадии"), на котором система должна остановится и вернуть данные по текущей стадии. В этом случае в ответе от сервера в поле state будет указана стадия которую запрашивают или одна из предыдущих стадий на которой была обнаружена ошибка (см. поле ответа status)
Тело запроса
 - arrival_date (string) - дата заезда в формате "DD-MM-YYYY" (по ISO-8601)
 - departure_date (string) - дата выезда в формате "DD-MM-YYYY" (по ISO-8601)
 - blocks ([]) - массив бронируемых объектов (комнат/тарифов)
 - tariff (string) - идентификатор тарифа бронируемого блока (room_id deprecated)
 - conditions.cancellation (int|false)**opt** - кол-во дней перед днем заезда после которого отмена не возможна
 - conditions.booking_method (int)**opt** - метод бронирования для данного блока (опионален. если присутствует - будет свалидирован с фактическим методом указаным в базе. используется только в случае если для клиента важно где и как платить)
 - recovery.unit (int)**opt** -  единица измерения  поля amount (% - "percent" или дни - "day")
 - recovery.amount (int)**opt** - кол-во ед. предоплаты (1-9 - дни 10-100 - проценты)
 - recovery.sum (int)**opt** - общая сумма пердоплаты в денежном эквиваленте
 - totalCost (int) - стоимость проживания в блоке за весь период
 - qty (int) - количество бронируемых блоков этого типа (тарифа)
 - living ([]) - массив проживающих (на каждый qty или один на все. в случае, если проживающих не достаточно, будет выбран тот, который указан в поле "request.requisites")
 - [first_name] (string) - имя проживающего в блоке
 - [last_name] (string) - фамилия проживающего в блоке
 - requisites.first_name (string) - имя
 - requisites.last_name (string) - фамилия
 - requisites.email (string) - e-mail адресс
 - requisites.phone (string) - телефон
 - request_id (string) - идентификатор запроса (в случае продолжения бронирования с определенной стадии - state)
 - next_state (string) - состояние на котором желательно провести остановку.
 - accepted (bool|int) - идентификатор приятия данных по предварительно остановленному nextState состоянию (state)

______________________________________________________

hotel_id - проверяется сисемой по "request.blocks.tariff" забронировать номера/блоки из разных отелей невозможно. Будет возвращена ошибка (todo разработать ошибку) 

Ответы от сервера
Ответ от сервера приходит в стандартном формате json вида:
 ```json
 {"ok":1, "data":responseBody, "msg":"ok"}
 ```
 Где `responseBody` для текущего метода это json со следующими свойствами:

 - **state** - стадия бронирования на которой была завершена обработка запроса (см. стадии)
 - **booking** - объект с набором текущих свойств бронирования . Соответствует телу полного запроса (включая opt параметры) и с дополнительным полем generalConditions где указаны общие условия по всем блокам бронирования. В остальном данные такие же как в запросе за исключением управляющих директив (next_state,accepted)
 - **status** - идентификатор состояния бронирования текущей стадии (state) может иметь следующие значения:
 -- `"ok"` - все хорошо. к состоянию пришли успешно
 -- `"error"` - ошибка уровня приложения. в таких случаях лучше попробовать позже или известить
 -- `"requirements"` - некоторые критические данные не предоставлены
 -- `"rejected"` - ошибка интерполяции данных. Какой-то набор данных фактически (имеющийся в базе) не соответствует представленному в запросе. В этом случае в statusBody будет присутствовать набор данных которые были отвергнуты со структурой повторяющей структуру запроса, но вместо скалярных значений каждого параметра будет присутствовать массив с двумя скалярными значениями где первый элемент это переданое значение, а второй - фактическое (которое не соответствует ему) (todo: возможно не нужно передавать массивами а сразу скалярки фактические отдавать. оригинальные данные запроса ведь и так есть в responseBody.booking )
 -- `"failure"` - переданы ошибочные данные (форматы, неверные ссылки и т.п.) в поле responseBody.statusBody будет передан объект указывающий на некорректные данные с кодом ошибки (см. коды ошибок) например ответ с: "statusBody":{"arrival_date": 31415} говорит о том, что поле arrival_date в запросе №данулось
мейнтейнера
 - **statusBody** - дополнительная информация о состоянии процесса бронирования.
 - **request_id** - идентификатор запроса для того чтобы повторно не отправлять весь блок данных, а только тот, который необходим для текущей стадии или с параметром запроса accept. Необходим в запросах для стадий начиная с postConditions.

Стадии бронирования [state] 
 - **preConditions** - этап без идентификатора брони. Может быть использован параметром nextState только для проверки доступности брони по переданным данным.
 - **postConditions** - демонстрация сложившихся условий бронирования
 - **preRequisites** - ожидание ввода реквизитов
 - **postRequisites** - демонстрация введенных реквизитов для подтверждения
 ... состояния касающиеся оплат
 - **complete** - бронирование завершено.